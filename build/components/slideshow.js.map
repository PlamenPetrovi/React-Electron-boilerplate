{"version":3,"sources":["../../app/components/slideshow.js"],"names":["Slideshow","utils","getConfig","slideshow","undefined","enabled","params","delay","activatesAfterSeconds","duration","secondsPerImages","console","log","self","mousemove","stop","start","numImgs","map","src","get","length","slideshowDelay","setTimeout","setInterval","arr","idx","Math","floor","random","clzz","prevImg","append","fadeIn","remove","callback","clearTimeout","clearInterval","fadeOut","default"],"mappings":";;;;;;;;;;;;;;;AAoBA;;;;AAEA;;;;;;AAtBA;;;;;;;;;;;;;;;;;;;;IAyBMA,S;AAEJ,uBAAc;AAAA;;;AAEZ,QAAIC,gBAAMC,SAAN,GAAkBC,SAAlB,KAAgCC,SAAhC,IAA6CH,gBAAMC,SAAN,GAAkBC,SAAlB,CAA4BE,OAA7E,EAAsF;AACpF,UAAIC,SAASL,gBAAMC,SAAN,GAAkBC,SAA/B;;AAEA,WAAKE,OAAL,GAAe,IAAf;;AAEA,WAAKE,KAAL,GAAc,OAAOD,OAAOE,qBAAd,IAAuC,QAAxC,GAAoDF,OAAOE,qBAA3D,GAAmF,EAAhG;AACA,WAAKC,QAAL,GAAiB,OAAOH,OAAOI,gBAAd,IAAkC,QAAnC,GAA+CJ,OAAOI,gBAAtD,GAAyE,CAAzF;AACA,UAAI,KAAKD,QAAL,GAAgB,CAApB,EAAuB,KAAKA,QAAL,GAAgB,CAAhB;;AAGvBE,cAAQC,GAAR,CAAY,oBAAZ;;AAEA,UAAIC,OAAO,IAAX;AACA,4BAAE,MAAF,EAAUC,SAAV,CAAoB,YAAW;AAC7BD,aAAKE,IAAL;AACAF,aAAKG,KAAL;AACD,OAHD;;AAKA,WAAKA,KAAL;AAED,KApBD,MAoBO;AACL,WAAKX,OAAL,GAAe,KAAf;AACD;AAGF;;;;4BAEO;;AAEN,UAAIY,UAAU,sBAAE,cAAF,EAAkBC,GAAlB,CAAsB,YAAW;AAAE,eAAO,KAAKC,GAAZ;AAAkB,OAArD,EAAuDC,GAAvD,GAA6DC,MAA3E;AACA,UAAI,KAAKhB,OAAL,IAAgBY,UAAU,CAA9B,EAAiC;AAC/B,YAAIJ,OAAO,IAAX;AACAA,aAAKS,cAAL,GAAsBC,WAAW,YAAW;AAC1CV,eAAKV,SAAL,GAAiBqB,YAAY,YAAW;AACtC;AACA,gBAAIC,MAAM,sBAAE,cAAF,EAAkBP,GAAlB,CAAsB,YAAW;AAAE,qBAAO,KAAKC,GAAZ;AAAkB,aAArD,EAAuDC,GAAvD,EAAV;AACA,gBAAIM,MAAMC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgBJ,IAAIJ,MAA/B,CAAV;AACA,gBAAIS,OAAO,eAAaJ,GAAxB;;AAEA,gBAAIb,KAAKkB,OAAL,IAAgBD,IAApB,EAA0B;AACxBJ,oBAAOA,MAAI,CAAJ,GAAQD,IAAIJ,MAAb,GAAuBK,MAAI,CAA3B,GAA+BA,MAAI,CAAzC;AACD;;AAED,kCAAE,UAAF,EAAcM,MAAd,CAAqB,wBAAsBF,IAAtB,GAA2B,mDAA3B,GAAiFL,IAAIC,GAAJ,CAAjF,GAA4F,MAAjH;AACA,kCAAE,gBAAcI,IAAhB,EAAsBG,MAAtB,CAA6B,IAA7B,EAAmC,YAAW;;AAE9C,kBAAIpB,KAAKkB,OAAL,KAAiB3B,SAArB,EAAiC,sBAAES,KAAKkB,OAAP,EAAgBG,MAAhB;AACjCrB,mBAAKkB,OAAL,GAAe,gBAAcD,IAA7B;AACC,aAJD;;AAMA;AACA;AAED,WApBgB,EAoBdjB,KAAKJ,QAAL,GAAc,IApBA,CAAjB;AAqBD,SAtBqB,EAsBnBI,KAAKN,KAAL,GAAW,IAtBQ,CAAtB;AAuBD;AAEF;;;yBAEI4B,Q,EAAU;AACb,UAAI,KAAK9B,OAAT,EAAkB;AAChB+B,qBAAa,KAAKd,cAAlB;AACAe,sBAAc,KAAKlC,SAAnB;AACA,8BAAE,YAAF,EAAgBmC,OAAhB,CAAwB,GAAxB,EAA6B,YAAW;AACtC,cAAIH,QAAJ,EAAcA;AACf,SAFD;AAGD,OAND,MAMO;AACL,YAAIA,QAAJ,EAAcA;AACf;AACF;;;;;AAOH;;;;;AAGA,IAAIhC,YAAY,IAAIH,SAAJ,EAAhB;QACsBuC,O,GAAbpC,S","file":"slideshow.js","sourcesContent":["/* \n * This file is part of \"photo-booth\" \n * Copyright (c) 2018 Philipp Trenz\n *\n * For more information on the project go to\n * <https://github.com/philipptrenz/photo-booth>\n * \n * This program is free software: you can redistribute it and/or modify  \n * it under the terms of the GNU General Public License as published by  \n * the Free Software Foundation, version 3.\n *\n * This program is distributed in the hope that it will be useful, but \n * WITHOUT ANY WARRANTY; without even the implied warranty of \n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU \n * General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License \n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\n\nimport utils from \"./utils.js\";\n\n\nclass Slideshow {\n\n  constructor() {\n\n    if (utils.getConfig().slideshow !== undefined && utils.getConfig().slideshow.enabled) {\n      var params = utils.getConfig().slideshow;\n\n      this.enabled = true;\n\n      this.delay = (typeof params.activatesAfterSeconds == 'number') ? params.activatesAfterSeconds : 30;\n      this.duration = (typeof params.secondsPerImages == 'number') ? params.secondsPerImages : 8;\n      if (this.duration < 4) this.duration = 4;\n\n\n      console.log('slideshow: enabled');\n\n      var self = this;\n      $('body').mousemove(function() {\n        self.stop();\n        self.start();\n      });\n      \n      this.start();\n\n    } else {\n      this.enabled = false;\n    }\n    \n    \n  }\n\n  start() {\n\n    var numImgs = $('#collage img').map(function() { return this.src; }).get().length;\n    if (this.enabled && numImgs > 2) {\n      var self = this;\n      self.slideshowDelay = setTimeout(function() {\n        self.slideshow = setInterval(function() {\n          // get all image sources and choose one randomly\n          var arr = $('#collage img').map(function() { return this.src; }).get();\n          var idx = Math.floor(Math.random() * arr.length);\n          var clzz = \"slideshow-\"+idx;\n\n          if (self.prevImg == clzz) {\n            idx = (idx+1 < arr.length) ? idx+1 : idx-1;\n          }\n\n          $('#collage').append(\"<div id='slideshow-\"+clzz+\"' class='slideshow' style='background-image: url(\" + arr[idx] + \");'>\");\n          $('#slideshow-'+clzz).fadeIn(3000, function() {\n          \n          if (self.prevImg !== undefined)  $(self.prevImg).remove();\n          self.prevImg = '#slideshow-'+clzz;\n          });\n\n          //$('#slideshow').css('background-image', 'url(\"' + arr[idx] + '\")');\n          //if ($('#slideshow:hidden')) $('#slideshow').fadeIn(3000);\n\n        }, self.duration*1000);\n      }, self.delay*1000);\n    }\n    \n  }\n\n  stop(callback) {\n    if (this.enabled) {\n      clearTimeout(this.slideshowDelay);\n      clearInterval(this.slideshow);\n      $('.slideshow').fadeOut(500, function() {\n        if (callback) callback();\n      });\n    } else {\n      if (callback) callback();\n    }\n  }\n\n\n\n}\n\n\n/*\n * Module exports for connection\n */\nlet slideshow = new Slideshow() \nexport { slideshow as default };"]}