{"version":3,"sources":["../../app/components/prompt.js"],"names":["Prompt","html","duration","active","activated","container","stay","instant","callback","slideshow","stop","self","fadeIn","timeout","setTimeout","clearTimeout","undefined","fadeOutTime","fadeOut","SpinnerPrompt","PreviewPrompt","filepath","CameraErrorPrompt","CameraErrorOnStartupPrompt","SharpErrorPrompt","CountdownPrompt","htmlPre","htmlPost","children","interval","setInterval","clearInterval","default"],"mappings":"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","file":"prompt.js","sourcesContent":["/* \n * This file is part of \"photo-booth\" \n * Copyright (c) 2018 Philipp Trenz\n *\n * For more information on the project go to\n * <https://github.com/philipptrenz/photo-booth>\n * \n * This program is free software: you can redistribute it and/or modify  \n * it under the terms of the GNU General Public License as published by  \n * the Free Software Foundation, version 3.\n *\n * This program is distributed in the hope that it will be useful, but \n * WITHOUT ANY WARRANTY; without even the implied warranty of \n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU \n * General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License \n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nimport $ from 'jquery';\nimport slideshow from \"./slideshow.js\";\n\nclass Prompt {\n\n\t/*\n\t * If duration < 0: No timeout\n\t */\n\tconstructor(html, duration) {\n\t\tthis.active = false;\n\t\tthis.activated = true;\n\t\tthis.duration = duration;\n\t\tthis.container = $(\"#prompt\");\n\t\tthis.html = html;\n\t}\n\n\tstart(stay=false, instant=false, callback) {\n\t\tslideshow.stop(); // stop slideshow if running\n\t\tvar self = this;\n\t\tif (self.activated && !self.active) {\n\t\t\tself.active = true;\n\t\t\t$(self.container).html(self.html);\n\t\t\t$(self.container).fadeIn(250);\n\t\t\t\n\t\t\tif (self.duration >= 0 ) {\n\t\t\t\tself.timeout = setTimeout(function(){ \n\t\t\t\t\tself.stop(stay, instant, callback);\n\t\t\t\t}, self.duration*1000);\n\t\t\t}\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\n\tstop(stay=false, instant=false, callback) {\n\t\tvar self = this;\n\t\tself.activated = false;\t// prevent from starting after stop() was called\n\t\tif (self.active) {\n\t\t\tclearTimeout(self.timeout);\n\n\t\t\tif (stay) {\n\t\t\t\t$(self.container).html('');\n\t\t\t\tself.active = false;\n\t\t\t\tif (callback !== undefined) callback();\n\t\t\t} else {\n\t\t\t\tvar fadeOutTime = instant ? 0 : 250;\n\t\t\t\t$(self.container).fadeOut(fadeOutTime, function() {\n\t\t\t\t\t$(self.container).html('');\n\t\t\t\t\tself.active = false;\n\t\t\t\t\tif (callback !== undefined) callback();\n\t\t\t\t});\n\t\t\t}\n\n\t\t} else {\n\t\t\tif (callback !== undefined) callback();\n\t\t}\n\t}\n\n}\n\nclass SpinnerPrompt extends Prompt {\n\n\tconstructor() {\n\t\tsuper('<div class=\"loading\"><i class=\"fa fa-circle-o-notch fa-spin fa-3x fa-fw\"></i></div>', -1);\n\t}\n\n}\n\nclass PreviewPrompt extends Prompt {\n\n\tconstructor(filepath, duration) {\n\t\tsuper('<div id=\\'preview\\' style=\\'background-image: url(\\\"'+filepath+'\\\");\\'></div>', duration);\n\t}\n}\n\nclass CameraErrorPrompt extends Prompt {\n\n\tconstructor(duration) {\n\t\tsuper('<div class=\"error\"><i class=\"fa fa-camera\" aria-hidden=\"true\"></i>  Whoops ...<br /><p>Something went wrong, please check the camera and try again</p></div>', duration);\n\t}\n}\n\nclass CameraErrorOnStartupPrompt extends Prompt {\n\n\tconstructor(duration) {\n\t\tsuper('<div class=\"error\"><i class=\"fa fa-camera\" aria-hidden=\"true\"></i>  Oh no ...<br /><p>No camera found. Please check the connection and test by triggering a photo</p></div>', duration);\n\t}\n}\n\nclass SharpErrorPrompt extends Prompt {\n\n\tconstructor(duration) {\n\t\tsuper('<div class=\"error\"><i class=\"fa fa-exclamation-triangle\" aria-hidden=\"true\"></i>  Whoops ...<br /><p>Something went wrong when saving the photo, please try again</p></div>', duration);\n\t}\n}\n\n\nclass CountdownPrompt {\n\n\tconstructor(duration) {\n\t\tthis.active = false;\n\t\tthis.activated = true;\n\t\tthis.duration = duration;\n\t\tthis.container = $(\"#prompt\");\n\n\t\tthis.htmlPre = '<span id=\"countdown\">';\n\t\tthis.htmlPost = '</span>';\n\t}\n\n\tstart(stay=false, instant=false, callback) {\n\t\tslideshow.stop();\n\t\tvar self = this;\n\t\tif (self.activated && !self.active) {\n\t\t\tself.active = true;\n\t\t\t$(self.container).fadeIn(250);\n\n\t\t\t// first time run immediatly\t\n\t\t\tself.html = self.htmlPre + self.duration + self.htmlPost;\n\t\t\t$(self.container).html(self.html);\n\t\t\t$(self.container).children().fadeOut(900);\n\t\t\tself.duration--;\n\n\t\t\tself.interval = setInterval(function() {\n\t\t\t\tif (self.duration > 0) {\n\t\t\t\t\tself.html = self.htmlPre + self.duration + self.htmlPost;\n\t\t\t\t\t$(self.container).html(self.html);\n\t\t\t\t\t$(self.container).children().fadeOut(900);\n\t\t\t\t\tself.duration--;\n\t\t\t\t} else {\n\t\t\t\t\tclearInterval(self.interval);\n\t\t\t\t\tself.stop(stay, instant, callback);\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t\t\n\t}\n\n\tstop(stay=false, instant=false, callback) {\n\t\tvar self = this;\n\t\tthis.activated = false;\t// prevent from starting after stop() was called\n\t\tif (self.active) {\n\t\t\tclearInterval(self.interval);\n\t\t\tif (stay) {\n\t\t\t\t$(self.container).html('');\n\t\t\t\tself.active = false;\n\t\t\t\tif (callback !== undefined) callback();\n\t\t\t} else {\n\t\t\t\tvar fadeOutTime = instant ? 0 : 250;\n\t\t\t\t$(self.container).fadeOut(fadeOutTime, function() {\n\t\t\t\t\t$(self.container).html('');\n\t\t\t\t\tself.active = false;\n\t\t\t\t\tif (callback !== undefined) callback();\n\t\t\t\t});\n\t\t\t}\n\n\t\t} else {\n\t\t\tif (callback !== undefined) callback();\n\t\t}\n\t}\n\n\n}\n\n/*\n * Module exports for connection\n */\nexport { Prompt as default, SpinnerPrompt, CountdownPrompt, PreviewPrompt, CameraErrorPrompt, CameraErrorOnStartupPrompt, SharpErrorPrompt };"]}